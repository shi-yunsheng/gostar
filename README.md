# GoStar

GoStar æ˜¯ä¸€ä¸ªè½»é‡çº§ã€åŠŸèƒ½å®Œå–„çš„ Go Web æ¡†æ¶ï¼Œæä¾›ç®€æ˜å‹å¥½çš„ APIï¼Œå¸®åŠ©ä½ åœ¨æœ€çŸ­æ—¶é—´å†…æ­å»ºç”Ÿäº§å¯ç”¨çš„ Web æœåŠ¡ã€‚

## ç‰¹æ€§æ¦‚è§ˆ
- ğŸš€ **å¿«é€Ÿä¸Šæ‰‹**ï¼šç›´è§‚çš„ API è®¾è®¡ä¸åˆç†çš„é»˜è®¤å€¼ï¼Œå‡ åˆ†é’Ÿå³å¯è·‘é€šé¡¹ç›®ã€‚ 
- ğŸ›£ï¸ **çµæ´»è·¯ç”±**ï¼šæ”¯æŒåµŒå¥—è·¯ç”±ã€æ­£åˆ™è·¯ç”±ã€å¯é€‰è·¯å¾„å‚æ•°ä¸è·¯ç”±çº§ä¸­é—´ä»¶ã€‚ 
- ğŸ”Œ **ä¸­é—´ä»¶ä½“ç³»**ï¼šå†…ç½®é”™è¯¯æ¢å¤ã€è®¿é—®æ—¥å¿—ã€CORSã€é€Ÿç‡é™åˆ¶ç­‰å¸¸ç”¨ä¸­é—´ä»¶ï¼Œå¯æŒ‰éœ€æ‹“å±•ã€‚ 
- ğŸ“¡ **è‡ªåŠ¨å“åº”**ï¼šå¤„ç†å™¨ç›´æ¥è¿”å› `any`ï¼Œæ¡†æ¶è‡ªåŠ¨å°è£…ä¸º JSONï¼›è‹¥å·²æ‰‹åŠ¨å†™å…¥å“åº”ä½“åˆ™ä¸ä¼šé‡å¤è¾“å‡ºã€‚ 
- ğŸŒ **é™æ€ & SPA & WebSocket**ï¼šåŒä¸€å¥—è·¯ç”±ä½“ç³»å³å¯æ‰¿è½½é™æ€èµ„æºã€å•é¡µåº”ç”¨ä»¥åŠ WebSocket å®æ—¶é€šä¿¡ã€‚ 
- ğŸ’¾ **æ•°æ®æ¥å…¥**ï¼šåŸç”Ÿæ”¯æŒ MySQLã€PostgreSQLã€SQLiteã€MongoDB ä¸ Redisï¼Œæä¾›ç»Ÿä¸€çš„åˆå§‹åŒ–æµç¨‹ã€‚ 
- ğŸªµ **æ—¥å¿—ç³»ç»Ÿ**ï¼šå½©è‰²æ§åˆ¶å°è¾“å‡ºã€æ–‡ä»¶ä¿å­˜ã€è‡ªåŠ¨å½’æ¡£ä¸æ¸…ç†ï¼Œæ»¡è¶³å¼€å‘åˆ°ç”Ÿäº§çš„æ—¥å¿—éœ€æ±‚ã€‚ 
- âš™ï¸ **é…ç½®ä¸­å¿ƒ**ï¼šå†…ç½® YAML é…ç½®è§£æï¼Œé¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹é…ç½®æ–‡ä»¶ã€‚ 
- âš¡ **ç¨³å®šé«˜æ•ˆ**ï¼šåŸºäºæ ‡å‡†åº“ `net/http` æ„å»ºï¼Œæ ¸å¿ƒå®ç°ç®€æ´å¯é ã€‚ 

## å®‰è£…
```bash
go get -u github.com/shi-yunsheng/gostar@v1.0.26-beta
```

## å¿«é€Ÿå¼€å§‹
```go
package main

import (
    "fmt"

    "github.com/shi-yunsheng/gostar"
    "github.com/shi-yunsheng/gostar/logger"
    "github.com/shi-yunsheng/gostar/router"
    "github.com/shi-yunsheng/gostar/router/handler"
)

func main() {
    app := gostar.New()

    app.UseRouter([]router.Route{
        {
            Method: router.GET,
            Path:   "/ping",
            Handler: func(w *handler.Response, r handler.Request) any {
                return map[string]string{"message": "pong"}
            },
        },
        {
            Method: router.GET,
            Path:   "/hello/{name?:str}",
            Handler: func(w *handler.Response, r handler.Request) any {
                name, _ := r.GetParam("name").(string)
                if name == "" {
                    name = "gostar"
                }
                return map[string]string{
                    "greeting": fmt.Sprintf("Hello %s", name),
                }
            },
        },
        {
            Method: router.GET,
            Path:   "/error",
            Handler: func(w *handler.Response, r handler.Request) any {
                panic("demo error")
            },
        },
    })

    if err := app.Run(); err != nil {
        logger.E("failed to run server: %v", err)
    }
}
```

## æ¡†æ¶èƒ½åŠ›
### è·¯ç”±ç³»ç»Ÿ
- æ”¯æŒé™æ€è·¯ç”±ã€æ­£åˆ™è·¯ç”±ã€è·¯å¾„å‚æ•°ï¼ˆå«å¯é€‰å‚æ•°ä¸é»˜è®¤å€¼ï¼‰ä»¥åŠå¤šçº§åµŒå¥—ã€‚
- è·¯ç”±èŠ‚ç‚¹å¯å•ç‹¬æŒ‡å®šä¸­é—´ä»¶ã€é™æ€èµ„æºæ‰˜ç®¡ã€WebApp é¢„å¤„ç†æˆ– WebSocket å‡çº§é…ç½®ã€‚
- å†…ç½®å¤šè¯­è¨€è·¯å¾„å‚æ•°æ ¡éªŒï¼Œè‡ªåŠ¨å°†åŒ¹é…ç»“æœå†™å…¥ `handler.Request` ä¾›å¤„ç†å™¨è¯»å–ã€‚

### ä¸­é—´ä»¶
- æ¡†æ¶é»˜è®¤å¯ç”¨é”™è¯¯æ¢å¤ã€è¯·æ±‚æ—¥å¿—ã€CORS ä¸‰ä¸ªå…¨å±€ä¸­é—´ä»¶ã€‚
- é€šè¿‡ `UseMiddleware` ä¸è·¯ç”±çº§ `Middleware` å­—æ®µå³å¯å®ç°â€œæ´‹è‘±æ¨¡å‹â€å¤„ç†é“¾ã€‚
- å®˜æ–¹æä¾›çš„ `middleware.RateLimitMiddleware` å¯å¿«é€Ÿå®ç° IP + è·¯å¾„ç²’åº¦çš„é™æµä¿æŠ¤ã€‚

### è¯·æ±‚ / å“åº”å¤„ç†
- å¤„ç†å™¨ç­¾åï¼š`type Handler func(w *Response, r Request) any`ã€‚
- è‹¥å¤„ç†å™¨æœªå†™å…¥å“åº”ä½“ï¼Œè¿”å›å€¼ä¼šè¢«è‡ªåŠ¨åºåˆ—åŒ–ä¸º JSONã€‚
- å†…ç½® `Response` å¯¹è±¡å¯æ–¹ä¾¿åœ°å†™å…¥ JSON / HTML / Textã€ç®¡ç†å“åº”å¤´ã€è·å– WebSocket è¿æ¥ç­‰ã€‚
- é€šè¿‡ `Request` å¯¹è±¡å³å¯è®¿é—®è·¯å¾„å‚æ•°ã€æŸ¥è¯¢å‚æ•°ã€è¯·æ±‚ä½“ã€ä¸Šä¼ æ–‡ä»¶ä»¥åŠ WebSocket çŠ¶æ€ã€‚

### é™æ€èµ„æºã€WebApp ä¸ WebSocket
- `handler.StaticServer` æ”¯æŒé™é€Ÿä¸‹è½½ã€ç±»å‹ç™½åå•ã€ä¸Šä¼ ç›®å½•ä¸å›è°ƒç­‰é«˜çº§èƒ½åŠ›ã€‚
- `handler.WebApp` å¯ä¸º SPA è‡ªåŠ¨å…œåº•æœªå‘½ä¸­çš„å­è·¯å¾„ï¼Œå¤©ç„¶æ”¯æŒ History / Hash æ¨¡å¼ã€‚
- `handler.ToWebsocketHandler` ç®€åŒ– WebSocket å‡çº§æµç¨‹ï¼Œæä¾›çº¿ç¨‹å®‰å…¨çš„æ¶ˆæ¯è¯»å†™å°è£…ã€‚

### æ•°æ®ä¸é…ç½®
- `model` æ¨¡å—æä¾›æ•°æ®åº“åˆå§‹åŒ–ã€CRUD æ‰©å±•ã€åˆ†é¡µã€å…³è”æŸ¥è¯¢ç­‰èƒ½åŠ›ï¼Œå…¼å®¹ GORM ä¸ MongoDBã€‚
- `model.InitRedis` æ”¯æŒå¤šå®ä¾‹é…ç½®ï¼Œå†…ç½®å¸¸è§çš„è¿æ¥ä¸è¶…æ—¶æ§åˆ¶é€‰é¡¹ã€‚
- `config.go` å†…ç½® YAML é…ç½®è§£æé€»è¾‘ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½å¹¶æ³¨å…¥åˆ°æ¡†æ¶ä¸Šä¸‹æ–‡ã€‚

### æ—¥å¿—ç³»ç»Ÿ
- `logger` æ¨¡å—åŸç”Ÿæ”¯æŒå½©è‰²è¾“å‡ºã€æ–‡ä»¶ä¿å­˜ã€æœ€å¤§æ–‡ä»¶å¤§å°ã€æœ€å¤§ä¿å­˜å¤©æ•°ä¸è‡ªåŠ¨åˆ é™¤ç­–ç•¥ã€‚
- ä¸æ¡†æ¶æ·±åº¦é›†æˆï¼šåˆå§‹åŒ–é˜¶æ®µæ ¹æ®é…ç½®è‡ªåŠ¨å¼€å¯æˆ–å…³é—­ç›¸å…³åŠŸèƒ½ã€‚

## é¡¹ç›®ç»“æ„
```
gostar/
â”œâ”€â”€ gostar.go          # æ¡†æ¶å…¥å£ä¸ç”Ÿå‘½å‘¨æœŸæ§åˆ¶
â”œâ”€â”€ config.go          # é…ç½®è§£æå¤„ç†
â”œâ”€â”€ router/            # è·¯ç”±ç³»ç»Ÿ
â”‚   â”œâ”€â”€ router.go      # Router å®ç°
â”‚   â”œâ”€â”€ route.go       # è·¯ç”±é…ç½®ç»“æ„
â”‚   â”œâ”€â”€ path.go        # è·¯å¾„è§£æä¸å‚æ•°æå–
â”‚   â”œâ”€â”€ handler/       # è¯·æ±‚å¤„ç†ã€å“åº”å°è£…ã€é™æ€/WS/WebApp æ”¯æŒ
â”‚   â””â”€â”€ middleware/    # æ¡†æ¶å†…ç½®ä¸­é—´ä»¶
â”œâ”€â”€ model/             # æ•°æ®åº“ / Redis æ”¯æŒ
â”œâ”€â”€ logger/            # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ utils/             # é€šç”¨å·¥å…·å‡½æ•°ä¸è¾…åŠ©æ–¹æ³•
â””â”€â”€ demo/              # ç¤ºä¾‹ç¨‹åº
```

## ç³»ç»Ÿè¦æ±‚
- Go 1.25.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

## ä¾èµ–
- `gorm.io/gorm`
- `go.mongodb.org/mongo-driver`
- `github.com/go-redis/redis`
- `github.com/gorilla/websocket`
- `gopkg.in/yaml.v3`

## è®¸å¯è¯
é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## è´¡çŒ®
æ¬¢è¿æäº¤ Issue ä¸ Pull Requestï¼
